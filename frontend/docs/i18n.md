# Internationalization (i18n)

## Overview

This project uses `react-i18next` for internationalization with support for:
- **Hebrew (he)** - Right-to-left, default language
- **English (en)** - Left-to-right
- **Russian (ru)** - Left-to-right

## Setup

The i18n configuration is located in `src/i18n/config.ts`:

```typescript
import i18n from 'i18next';
import { initReactI18next } from 'react-i18next';
import LanguageDetector from 'i18next-browser-languagedetector';

i18n
  .use(LanguageDetector)
  .use(initReactI18next)
  .init({
    fallbackLng: 'he',
    supportedLngs: ['he', 'en', 'ru'],
    defaultNS: 'common',
    // ...
  });
```

## Translation Files

Translation files are located in `src/i18n/locales/`:

```
src/i18n/locales/
â”œâ”€â”€ he.json   # Hebrew translations
â”œâ”€â”€ en.json   # English translations
â””â”€â”€ ru.json   # Russian translations
```

### Namespaces

Translations are organized into namespaces:

| Namespace | Description |
|-----------|-------------|
| `common` | Common UI elements (buttons, labels, etc.) |
| `nav` | Navigation items |
| `a11y` | Accessibility labels |
| `validation` | Form validation messages |
| `dates` | Date/time formatting |
| `pwa` | PWA-related strings |
| `rooms` | Room-related strings |
| `tasks` | Task-related strings |
| `todos` | Subtask-related strings |
| `categories` | Category-related strings |
| `auth` | Authentication strings |
| `settings` | Settings page strings |
| `calendar` | Calendar strings |
| `toast` | Toast notification messages |
| `ml` | Machine learning features |
| `privacy` | Privacy consent dialog |

## Usage

### Basic Usage

```tsx
import { useTranslation } from 'react-i18next';

function MyComponent() {
  const { t } = useTranslation(); // Default namespace: 'common'
  
  return <h1>{t('app_name')}</h1>;
}
```

### With Specific Namespace

```tsx
function TaskList() {
  const { t } = useTranslation('tasks');
  
  return <h2>{t('title')}</h2>; // tasks.title
}
```

### Multiple Namespaces

```tsx
function MyComponent() {
  const { t } = useTranslation(['tasks', 'common']);
  
  return (
    <div>
      <h1>{t('tasks:title')}</h1>
      <button>{t('common:save')}</button>
    </div>
  );
}
```

### With Interpolation

```tsx
// Translation: "{{count}} ××©×™××•×ª"
const { t } = useTranslation('rooms');

t('tasks_count', { count: 5 }); // "5 ××©×™××•×ª"
```

### Pluralization

```tsx
// Translations:
// "tasks_count_one": "××©×™××” ××—×ª"
// "tasks_count_other": "{{count}} ××©×™××•×ª"

t('tasks_count', { count: 1 }); // "××©×™××” ××—×ª"
t('tasks_count', { count: 5 }); // "5 ××©×™××•×ª"
```

### Trans Component

For complex translations with embedded components:

```tsx
import { Trans } from 'react-i18next';

function Welcome() {
  return (
    <Trans i18nKey="welcome">
      Welcome to <strong>Home Organization</strong>!
    </Trans>
  );
}
```

## Language Switcher

### Basic Buttons

```tsx
import { LanguageSwitcher } from '@/components/LanguageSwitcher';

<LanguageSwitcher mode="buttons" />
```

### Dropdown

```tsx
<LanguageSwitcher mode="dropdown" />
```

### Compact

```tsx
<LanguageSwitcher mode="compact" />
```

### useLanguage Hook

```tsx
import { useLanguage } from '@/components/LanguageSwitcher';

function MyComponent() {
  const { code, name, isRTL, changeLanguage } = useLanguage();
  
  return (
    <div dir={isRTL ? 'rtl' : 'ltr'}>
      <p>Current: {name}</p>
      <button onClick={() => changeLanguage('en')}>Switch to English</button>
    </div>
  );
}
```

## RTL Support

### Automatic Direction

The language switcher automatically updates `<html dir="..." lang="...">` when language changes.

### Tailwind RTL Utilities

The project includes custom RTL-aware utilities:

```css
/* Logical properties */
.ms-auto { margin-inline-start: auto; }
.me-auto { margin-inline-end: auto; }
.ps-4 { padding-inline-start: 1rem; }
.pe-4 { padding-inline-end: 1rem; }
.text-start { text-align: start; }
.text-end { text-align: end; }
```

### RTL-aware Components

Use logical properties instead of directional:

```tsx
// âŒ Bad - doesn't respect RTL
<div className="ml-4 mr-2 text-left">

// âœ… Good - respects RTL
<div className="ms-4 me-2 text-start">
```

## Adding a New Language

1. Create translation file `src/i18n/locales/{code}.json`
2. Add language to `src/i18n/config.ts`:

```typescript
import newLangTranslations from './locales/new.json';

// In supportedLngs
supportedLngs: ['he', 'en', 'ru', 'new'],

// In resources
new: {
  common: newLangTranslations.common,
  // ...all namespaces
},
```

3. Add language to `LanguageSwitcher.tsx`:

```typescript
export const LANGUAGES = [
  // ...existing languages
  { code: 'new', name: 'New Language', nativeName: 'Native Name', flag: 'ğŸ³ï¸', dir: 'ltr' },
];
```

## Best Practices

### 1. Use Namespaces

Keep translations organized by feature/area:

```json
{
  "tasks": {
    "add_task": "×”×•×¡×£ ××©×™××”",
    "edit_task": "×¢×¨×•×š ××©×™××”"
  }
}
```

### 2. Use Keys, Not Text

```tsx
// âŒ Bad
t('Add new task');

// âœ… Good
t('tasks.add_task');
```

### 3. Provide Context

Use descriptive keys:

```json
{
  "button_save": "×©××•×¨",
  "button_cancel": "×‘×™×˜×•×œ",
  "title_tasks": "××©×™××•×ª"
}
```

### 4. Handle Missing Translations

The fallback language (Hebrew) is used if a translation is missing.

### 5. Date/Number Formatting

Use `dates` namespace or Intl API:

```tsx
// Date formatting
new Intl.DateTimeFormat(i18n.language, { 
  dateStyle: 'long' 
}).format(date);

// Number formatting
new Intl.NumberFormat(i18n.language).format(1234);
```

## Testing Translations

### Check for Missing Keys

```bash
# Find unused translations
npx i18next-parser 'src/**/*.{ts,tsx}'
```

### Unit Testing

```tsx
import { renderWithI18n } from '@/test-utils';

test('shows translated text', () => {
  const { getByText } = renderWithI18n(<MyComponent />, { lng: 'he' });
  expect(getByText('×”×•×¡×£ ××©×™××”')).toBeInTheDocument();
});
```

## Performance

### Lazy Loading Namespaces

For large applications, consider lazy loading namespaces:

```typescript
// vite.config.ts
import i18nextBackend from 'i18next-http-backend';

i18n
  .use(i18nextBackend)
  .init({
    backend: {
      loadPath: '/locales/{{lng}}/{{ns}}.json',
    },
  });
```

### Suspense Mode

Enable suspense for better loading UX:

```typescript
i18n.init({
  react: {
    useSuspense: true,
  },
});

// Wrap app with Suspense
<Suspense fallback={<Loading />}>
  <App />
</Suspense>
```

## Debugging

Enable debug mode in development:

```typescript
i18n.init({
  debug: process.env.NODE_ENV === 'development',
});
```

This will log:
- Missing translations
- Language detection results
- Namespace loading
